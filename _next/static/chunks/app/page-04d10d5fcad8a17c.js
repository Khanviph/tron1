(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{5489:(e,t,r)=>{Promise.resolve().then(r.bind(r,4880))},4880:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>p});var s=r(5155),n=r(2115);let a=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),l=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()};var i={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let o=(0,n.forwardRef)((e,t)=>{let{color:r="currentColor",size:s=24,strokeWidth:a=2,absoluteStrokeWidth:o,className:d="",children:c,iconNode:h,...u}=e;return(0,n.createElement)("svg",{ref:t,...i,width:s,height:s,stroke:r,strokeWidth:o?24*Number(a)/Number(s):a,className:l("lucide",d),...u},[...h.map(e=>{let[t,r]=e;return(0,n.createElement)(t,r)}),...Array.isArray(c)?c:[c]])}),d=(e,t)=>{let r=(0,n.forwardRef)((r,s)=>{let{className:i,...d}=r;return(0,n.createElement)(o,{ref:s,iconNode:t,className:l("lucide-".concat(a(e)),i),...d})});return r.displayName="".concat(e),r},c=d("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]),h=d("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),u=d("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),m=d("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),x=d("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),f=()=>{let e=(0,n.useRef)(null),t=(0,n.useRef)([]),r=(0,n.useRef)({x:0,y:0}),a=(0,n.useRef)(!1),[l,i]=(0,n.useState)(null),[o,d]=(0,n.useState)(!1),[f,p]=(0,n.useState)(""),[g,w]=(0,n.useState)(""),[y,b]=(0,n.useState)(""),[v,j]=(0,n.useState)([""]),[N,k]=(0,n.useState)(1);(0,n.useEffect)(()=>{let s;let n=e.current,l=n.getContext("2d"),i=()=>{n.width=window.innerWidth,n.height=window.innerHeight};i(),window.addEventListener("resize",i);class o{update(){this.x+=this.speedX,this.y+=this.speedY,this.life*=.95}draw(e){e.fillStyle=this.color+this.life+")",e.beginPath(),e.arc(this.x,this.y,this.size*this.life,0,2*Math.PI),e.fill()}constructor(e,t){this.x=e,this.y=t,this.size=3*Math.random()+2,this.speedX=2*Math.random()-1,this.speedY=2*Math.random()-1,this.life=1,this.color="hsla(".concat(60*Math.random()+200,", 100%, 70%, ")}}let d=()=>{if(l.fillStyle="rgba(0, 0, 0, 0.1)",l.fillRect(0,0,n.width,n.height),a.current)for(let e=0;e<3;e++)t.current.push(new o(r.current.x,r.current.y));t.current=t.current.filter(e=>(e.update(),e.draw(l),e.life>.01)),s=requestAnimationFrame(d)},c=e=>{r.current.x=e.clientX,r.current.y=e.clientY},h=()=>{a.current=!0},u=()=>{a.current=!1};return n.addEventListener("mousemove",c),n.addEventListener("mousedown",h),n.addEventListener("mouseup",u),n.addEventListener("mouseleave",u),d(),()=>{cancelAnimationFrame(s),window.removeEventListener("resize",i),n.removeEventListener("mousemove",c),n.removeEventListener("mousedown",h),n.removeEventListener("mouseup",u),n.removeEventListener("mouseleave",u)}},[]),(0,n.useEffect)(()=>{let e=async()=>{try{let e=window.tronWeb;console.log("当前节点:",e.fullNode.host),i(e);try{let t=await e.trx.getNodeInfo();console.log("节点信息:",t)}catch(e){console.warn("获取节点信息失败:",e)}}catch(e){console.error("连接错误:",e),p("网络连接失败，请检查网络设置")}};(async()=>{let t=0,r=()=>{window.tronWeb&&window.tronWeb.ready&&window.tronWeb.defaultAddress&&window.tronWeb.defaultAddress.base58?e():t<10?(t++,setTimeout(r,1e3)):p("未检测到TronLink或账户未解锁，请确保在TronLink中打开并解锁钱包")};r()})()},[]);let E=e=>{let t=v.filter((t,r)=>r!==e);j(t),N>t.length&&k(t.length)},C=(e,t)=>{let r=[...v];r[e]=t,j(r)},L=async()=>{try{if(d(!0),p(""),w(""),!window.tronWeb||!window.tronWeb.ready||!window.tronWeb.defaultAddress.base58)throw Error("请确保TronLink已连接并解锁账户");let e=window.tronWeb;if(!y||!e.isAddress(y))throw Error("被控制地址格式不正确");let t=v.filter(t=>t&&e.isAddress(t));if(0===t.length)throw Error("请至少添加一个有效的控制地址");if(t.length<N)throw Error("有效控制地址数量少于所需签名数");let r={owner_address:e.address.toHex(y),owner:{type:0,permission_name:"owner",threshold:N,keys:t.map(t=>({address:e.address.toHex(t),weight:1}))},actives:[{type:2,permission_name:"active",threshold:N,operations:"7fff1fc0033e0300000000000000000000000000000000000000000000000000",keys:t.map(t=>({address:e.address.toHex(t),weight:1}))}]};console.log("更新参数:",r);let s=await e.fullNode.request("/wallet/accountpermissionupdate",r,"post");if(!s||!s.txID)throw Error("创建交易失败");console.log("交易创建成功:",s);let n=Date.now();s.expiration=n+6e4,s.timestamp=n;let a=await e.trx.sign(s);console.log("交易已签名:",a);let l=await e.trx.sendRawTransaction(a);if(console.log("交易广播结果:",l),l.result){w("多签权限设置成功! 交易ID: ".concat(s.txID));return}throw Error("交易被拒绝")}catch(e){console.error("设置多签权限错误:",e),p(e.message||"设置失败，请重试")}finally{d(!1)}};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("canvas",{ref:e,className:"fixed inset-0 pointer-events-auto z-0",style:{backgroundColor:"transparent"}}),(0,s.jsx)("div",{className:"relative min-h-screen bg-gradient-to-br from-blue-50 to-indigo-50 py-8 px-4",children:(0,s.jsx)("div",{className:"max-w-2xl mx-auto relative z-10",children:(0,s.jsxs)("div",{className:"bg-white/90 backdrop-blur-sm rounded-2xl shadow-xl overflow-hidden",children:[(0,s.jsx)("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-600 px-6 py-8",children:(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsx)(c,{className:"w-12 h-12 text-white"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-white",children:"TRON多签权限设置"}),(0,s.jsx)("p",{className:"text-blue-100 mt-1",children:"安全可靠的多重签名管理工具"})]})]})}),(0,s.jsxs)("div",{className:"p-6",children:[f&&(0,s.jsxs)("div",{className:"flex items-center space-x-2 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6",children:[(0,s.jsx)(h,{className:"w-5 h-5 flex-shrink-0"}),(0,s.jsx)("p",{children:f})]}),g&&(0,s.jsxs)("div",{className:"flex items-center space-x-2 bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg mb-6",children:[(0,s.jsx)(u,{className:"w-5 h-5 flex-shrink-0"}),(0,s.jsx)("p",{children:g})]}),(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"被控制地址"}),(0,s.jsx)("input",{type:"text",value:y,onChange:e=>b(e.target.value),placeholder:"输入需要设置多签的地址",className:"w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition duration-200"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"控制地址列表"}),(0,s.jsxs)("div",{className:"space-y-3",children:[v.map((e,t)=>(0,s.jsxs)("div",{className:"flex gap-3",children:[(0,s.jsx)("input",{type:"text",value:e,onChange:e=>C(t,e.target.value),placeholder:"控制地址 ".concat(t+1),className:"flex-1 px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition duration-200"}),v.length>1&&(0,s.jsx)("button",{onClick:()=>E(t),className:"px-3 py-2 bg-red-100 text-red-600 rounded-lg hover:bg-red-200 transition duration-200",children:(0,s.jsx)(m,{className:"w-5 h-5"})})]},t)),v.length<5&&(0,s.jsxs)("button",{onClick:()=>{v.length<5&&j([...v,""])},className:"flex items-center space-x-2 text-blue-600 hover:text-blue-700 transition duration-200",children:[(0,s.jsx)(x,{className:"w-5 h-5"}),(0,s.jsx)("span",{children:"添加地址"})]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"所需签名数"}),(0,s.jsx)("input",{type:"number",value:N,onChange:e=>k(Math.min(parseInt(e.target.value)||1,v.length)),min:1,max:v.length,className:"w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition duration-200"})]}),(0,s.jsx)("button",{onClick:L,disabled:o,className:"w-full px-6 py-4 rounded-lg text-white font-medium transition duration-200 ".concat(o?"bg-gray-400 cursor-not-allowed":"bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 transform hover:scale-[1.02]"),children:o?"设置中...":"设置多签权限"})]}),(0,s.jsx)("div",{className:"mt-8 pt-6 border-t border-gray-100",children:(0,s.jsx)("p",{className:"text-sm text-gray-500 text-center",children:"作者 @xkbfdl • 有zjp,cx项目能出货的，可以考虑和我联系 • 欢迎中介技术和我对接"})})]})]})})})]})};function p(){return(0,s.jsx)("main",{className:"container mx-auto p-4",children:(0,s.jsx)(f,{})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[441,517,358],()=>t(5489)),_N_E=e.O()}]);